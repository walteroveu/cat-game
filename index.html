<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="猫咪指认物品">
    <meta name="theme-color" content="#FF6B6B">
    <title>猫咪指认物品小游戏</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/6827d6351cec4356968bc298698295a7.png~tplv-a9rns2rl98-24:720:720.png?rcl=2025122316233519D5AB42B335312F9DC3&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1767083016&x-signature=TuipAbmK07U2Q3Z9KJpBczhnTNY%3D" type="image/png">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B6B',
                        secondary: '#4ECDC4',
                        accent: '#FFE66D',
                        background: '#F7FFF7',
                        text: '#2F2F2F'
                    },
                    fontFamily: {
                        sans: ['Comic Sans MS', 'Arial', 'sans-serif']
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'float': 'float 3s ease-in-out infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite'
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .text-shadow-lg {
                text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.5);
            }
            .item-hover:hover {
                transform: scale(1.1);
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            }
            .cat-bounce {
                animation: cat-bounce 0.5s ease-in-out;
            }
            @keyframes cat-bounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-20px); }
            }
            .cat-point {
                animation: cat-point 1s ease-in-out infinite;
            }
            @keyframes cat-point {
                0%, 100% { transform: rotate(0deg); }
                25% { transform: rotate(-5deg); }
                75% { transform: rotate(5deg); }
            }
            .hand-animation {
                animation: hand-reach 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            }
            @keyframes hand-reach {
                0% { transform: scale(0.5) rotate(0deg); opacity: 0.7; }
                50% { transform: scale(1.05) rotate(5deg); opacity: 1; }
                100% { transform: scale(1) rotate(0deg); opacity: 1; }
            }
            .star-burst {
                position: relative;
            }
            .star-burst::before {
                content: '';
                position: absolute;
                top: -20px;
                left: -20px;
                right: -20px;
                bottom: -20px;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23FFD700' d='M463.952 0c-5.465 0-10.93 2.085-15.083 6.238L315.422 144.516l-126.84-94.758c-8.192-6.125-19.27-6.125-27.462 0L43.13 144.516 6.238 6.238C2.085 2.085-.001 7.558-.001 13.023s2.086 10.93 6.239 15.083l138.283 138.283L6.238 482.646c-4.153 4.153-6.238 9.618-6.238 15.083 0 5.465 2.085 10.93 6.238 15.083C10.39 510.002 15.855 512 21.32 512s10.93-2.085 15.083-6.238L192.516 367.422l126.84 94.758c8.192 6.125 19.27 6.125 27.462 0l126.84-94.758 138.283 138.283c4.153 4.153 9.618 6.238 15.083 6.238 5.465 0 10.93-2.085 15.083-6.238 4.153-4.153 6.238-9.618 6.238-15.083s-2.085-10.93-6.238-15.083L367.422 315.422l138.283-138.283c4.153-4.153 6.238-9.618 6.238-15.083s-2.085-10.93-6.238-15.083L463.952 0z'/%3E%3C/svg%3E");
                background-size: 20px;
                opacity: 0;
                animation: star-burst 0.5s ease-out forwards;
            }
            @keyframes star-burst {
                0% { opacity: 0; transform: scale(0); }
                50% { opacity: 1; }
                100% { opacity: 0; transform: scale(1.5); }
            }
            .floating-text {
                animation: floating-text 1s ease-out forwards;
            }
            @keyframes floating-text {
                0% { opacity: 1; transform: translateY(0); }
                100% { opacity: 0; transform: translateY(-50px); }
            }
            .speaker-icon {
                animation: speaker-pulse 1.5s ease-in-out infinite;
            }
            @keyframes speaker-pulse {
                0%, 100% { transform: scale(1); opacity: 0.7; }
                50% { transform: scale(1.2); opacity: 1; }
            }
            .item-shake {
                animation: item-shake 0.5s ease-in-out;
            }
            @keyframes item-shake {
                0%, 100% { transform: translate(0, 0) scale(1); }
                10% { transform: translate(-15px, -25px) scale(1.1); }
                20% { transform: translate(15px, 20px) scale(0.9); }
                30% { transform: translate(-15px, -25px) scale(1.1); }
                40% { transform: translate(15px, 20px) scale(0.9); }
                50% { transform: translate(-15px, -25px) scale(1.1); }
                60% { transform: translate(15px, 20px) scale(0.9); }
                70% { transform: translate(-15px, -25px) scale(1.1); }
                80% { transform: translate(15px, 20px) scale(0.9); }
                90% { transform: translate(-15px, -25px) scale(1.1); }
            }
        }
    </style>
</head>
<body class="bg-background min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 游戏标题 -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-primary text-shadow-lg mb-2">萝卜纸巾挑战</h1>
            <p class="text-xl text-text">已风靡动物界的挑战游戏！</p>
        </header>

        <!-- 游戏主界面 -->
        <main class="bg-white rounded-3xl shadow-xl p-6 md:p-8 mb-8">
            <!-- 猫咪和指令区域 -->
            <div class="flex flex-col md:flex-row items-center justify-between mb-8">
                <div class="w-full md:w-1/3 mb-6 md:mb-0 flex justify-center">
                    <div id="cat-container" class="relative">
                        <img id="cat-image" src="https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/6827d6351cec4356968bc298698295a7.png~tplv-a9rns2rl98-24:720:720.png?rcl=2025122316233519D5AB42B335312F9DC3&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1767083016&x-signature=TuipAbmK07U2Q3Z9KJpBczhnTNY%3D" alt="猫咪" class="w-48 h-48 object-contain animate-float">

                        <div id="speech-bubble" class="absolute top-0 right-0 transform translate-x-1/2 -translate-y-1/4 bg-accent text-text px-4 py-2 rounded-2xl shadow-lg flex items-center">
                            <div class="speaker-icon mr-2">
                                <i class="fa fa-volume-up text-primary"></i>
                            </div>
                            <p id="command-text" class="text-lg font-bold">请点击苹果！</p>
                        </div>
                    </div>
                </div>
                <div class="w-full md:w-2/3 flex flex-col items-center justify-center">
                    <div class="flex items-center mb-4">
                        <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/d1ea317be87f4413bd2e9ff20e34bdbe~tplv-a9rns2rl98-image.image?rcl=202512231616004061641C43E77112A60A&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1769069778&x-signature=WZSGA6RxCC4tLFvttS7GTywxw8o%3D" alt="小鱼干" class="w-12 h-12 object-contain mr-3">
                        <span class="text-2xl font-bold text-text">蒸蚌: <span id="score">0</span></span>
                    </div>
                </div>
            </div>

            <!-- 物品展示区域 -->
            <div id="items-container" class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <!-- 物品将通过JavaScript动态生成 -->
            </div>
        </main>

        <!-- 结果弹窗 -->
        <div id="result-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-3xl p-8 max-w-md w-full mx-4 transform transition-all">
                <h2 id="result-title" class="text-3xl font-bold text-center mb-4">游戏结束！</h2>
                <p id="result-message" class="text-xl text-center mb-6">你的得分是：<span id="final-score">0</span></p>
                <div class="flex justify-center">
                    <button id="restart-button" class="bg-primary hover:bg-primary/80 text-white font-bold py-3 px-8 rounded-full text-lg transition-all transform hover:scale-105">
                        再来一局
                    </button>
                </div>
            </div>
        </div>

        <!-- 真棒弹窗 -->
        <div id="success-modal" class="fixed inset-0 pointer-events-none flex items-center justify-end z-40 hidden">
            <div class="w-full max-w-xs text-center pr-4 md:pr-10">
                <p id="success-text" class="text-6xl font-bold text-primary text-shadow-lg floating-text">【蒸蚌】！</p>
            </div>
        </div>
    </div>

    <script>
        // 游戏数据
        const gameData = {
            items: [
                { id: 'carrot', name: '萝卜', image: 'https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/362140db564d4bdf999db240217c9118~tplv-a9rns2rl98-image.image?rcl=2025122316193038C5E5C4A833BB2AEEBB&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1769070001&x-signature=RLCHQXKOkOAstdvFo0ILX%2BWQajU%3D' },
                { id: 'tissue', name: '纸巾', image: 'https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/2cdad272ad3143e7a493cb17569eb7cb~tplv-a9rns2rl98-image.image?rcl=2025122316193038C5E5C4A833BB2AEEBB&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1769070001&x-signature=PQpIJOzrE%2F0zY7MF1dz3UMQ%2BU00%3D' }
            ],
            currentCommand: null,
            score: 0,
            gameOver: false
        };

        // DOM元素
        const itemsContainer = document.getElementById('items-container');
        const commandText = document.getElementById('command-text');
        const scoreElement = document.getElementById('score');

        const resultModal = document.getElementById('result-modal');
        const resultTitle = document.getElementById('result-title');
        const resultMessage = document.getElementById('result-message');
        const finalScoreElement = document.getElementById('final-score');
        const restartButton = document.getElementById('restart-button');
        const successModal = document.getElementById('success-modal');
        const successText = document.getElementById('success-text');
        const catImage = document.getElementById('cat-image');

        const catContainer = document.getElementById('cat-container');

        // 音频上下文（用于生成真棒音效）
        let audioContext;

        // 初始化游戏
        function initGame() {
            // 重置游戏数据
            gameData.score = 0;
            gameData.gameOver = false;
            
            // 更新UI
            scoreElement.textContent = gameData.score;
            
            // 隐藏结果弹窗
            resultModal.classList.add('hidden');
            
            // 生成新指令
            generateNewCommand();
            
            // 渲染物品
            renderItems();
            
            // 初始化音频上下文
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.warn('Web Audio API is not supported in this browser');
            }
        }

        // 生成新指令
        function generateNewCommand() {
            const randomIndex = Math.floor(Math.random() * gameData.items.length);
            gameData.currentCommand = gameData.items[randomIndex];
            commandText.textContent = gameData.currentCommand.name;
        }

        // 渲染物品
        function renderItems() {
            // 清空容器
            itemsContainer.innerHTML = '';
            
            // 随机排序物品
            const shuffledItems = [...gameData.items].sort(() => Math.random() - 0.5);
            
            // 创建物品元素
            shuffledItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'bg-white rounded-2xl shadow-md p-4 flex flex-col items-center cursor-pointer transition-all item-hover';
                itemElement.dataset.itemId = item.id;
                
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="w-24 h-24 object-contain mb-2">
                    <p class="text-lg font-bold text-text">${item.name}</p>
                `;
                
                // 添加点击事件
                itemElement.addEventListener('click', () => handleItemClick(item.id));
                
                itemsContainer.appendChild(itemElement);
            });
        }

        // 处理物品点击
        function handleItemClick(itemId) {
            if (gameData.gameOver) return;
            
            const isCorrect = itemId === gameData.currentCommand.id;
            
            if (isCorrect) {
                // 答对了
                gameData.score++;
                scoreElement.textContent = gameData.score;
                
                // 显示真棒弹窗
                showSuccessModal();
                
                // 播放真棒音效
                playSuccessSound();
                
                // 给猫咪图片添加抖动动效
                catImage.classList.remove('item-shake');
                // 触发重排以重新应用动画
                void catImage.offsetWidth;
                catImage.classList.add('item-shake');
                
                // 生成新指令
                setTimeout(() => {
                    generateNewCommand();
                    renderItems();
                }, 1500);
            } else {
                // 答错了，直接生成新指令
                generateNewCommand();
                renderItems();
            }
        }



        // 显示成功弹窗
        function showSuccessModal() {
            successModal.classList.remove('hidden');
            setTimeout(() => {
                successModal.classList.add('hidden');
            }, 1000);
        }

        // 播放成功音效（真棒语音）
        function playSuccessSound() {
            if (!audioContext) return;
            
            try {
                // 创建振荡器
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // 设置音频参数（简单的愉快音效）
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                oscillator.frequency.setValueAtTime(1046.5, audioContext.currentTime + 0.3); // C6
                
                // 设置音量
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                // 播放音效
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.warn('Error playing sound:', e);
            }
        }

        // 结束游戏
        function endGame() {
            gameData.gameOver = true;
            
            // 更新结果弹窗
            finalScoreElement.textContent = gameData.score;
            
            if (gameData.score >= 10) {
                resultTitle.textContent = '太棒了！';
                resultMessage.innerHTML = `你的得分是：<span id="final-score">${gameData.score}</span><br>你真是猫咪训练大师！`;
            } else if (gameData.score >= 5) {
                resultTitle.textContent = '做得不错！';
                resultMessage.innerHTML = `你的得分是：<span id="final-score">${gameData.score}</span><br>再接再厉！`;
            } else {
                resultTitle.textContent = '继续努力！';
                resultMessage.innerHTML = `你的得分是：<span id="final-score">${gameData.score}</span><br>多练习几次吧！`;
            }
            
            // 显示结果弹窗
            resultModal.classList.remove('hidden');
        }

        // 添加重新开始按钮事件
        restartButton.addEventListener('click', initGame);


        
        // 初始化游戏
        window.addEventListener('DOMContentLoaded', initGame);

        // 注册 Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker 注册成功:', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker 注册失败:', error);
                    });
            });
        }
    </script>
</body>
</html>